<!DOCTYPE html>

<html>

<head>
    <title>Coursaic</title>

    <!-- Third-party Stylesheets -->
    <link rel="stylesheet" type="text/css" href="./css/normalize.css" />

    <!-- Coursaic Stylesheets -->

    <!-- Component Styles -->
    <link rel="stylesheet" type="text/css" href="./css/comp.text.css" />
    <link rel="stylesheet" type="text/css" href="./css/comp.widgets.css" />
    
    <!-- Main Styles -->
    <link rel="stylesheet" type="text/css" href="./css/main.css" />
    <link rel="stylesheet" type="text/css" href="./css/main.header.css" />
    <link rel="stylesheet" type="text/css" href="./css/main.home.css" />

    <!-- Third-Party Scripts -->
    <script type="text/javascript" src="./lib/parse/parse.1.3.0.js"></script>
    <script type="text/javascript" src="./lib/react/react.js"></script>
    <script type="text/javascript" src="./lib/react/JSXTransformer.js"></script>

    <!-- My Scripts -->

    <!-- Models -->
    <script type="text/javascript" src="./js/action.js"></script>
    <script type="text/javascript" src="./js/stores.js"></script>
    <script type="text/javascript" src="./js/dispatcher.js"></script>

    <!-- Views -->
    <script type="text/javascript" src="./views/main.js"></script>
    <script type="text/jsx" src="./views/widgets.js"></script>
    <script type="text/jsx" src="./views/header.js"></script>
    <script type="text/jsx" src="./views/home.js"></script>

</head>

<body>
    <!-- HTML dynamically added via React js -->
    <script>
        Parse.initialize("4mcPYbWGU0hIVcVCW5XKMgY5Gtr7UuPlRZkPnWj1", "Bl2qeQ6LdbhLpgi8B2a7nCpeITBs8QBeDsQQlGd8");
        window.fbAsyncInit = function() {
            Parse.FacebookUtils.init({ // this line replaces FB.init({
                appId      : '275409559335896', // Facebook App ID
                status     : true, // check Facebook Login status
                cookie     : true, // enable cookies to allow Parse to access the session
                xfbml      : true,
                version    : 'v2.1'
            });
            Parse.FacebookUtils.logIn(null, {
                success: function(user) {
                    if (!user.existed()) {
                        // Get the user data from facebook.
                        // Note: This information might change. Current implementation
                        // assumes this never changes.
                        FB.api('/me', {fields: 'first_name,last_name,picture.type(square)'}, function(response) {
                            user.set('firstName', response.first_name);
                            user.set('lastName', response.last_name);
                            user.set('photoUrl', response.picture.data.url)
                            user.save();

                            // Render after all the data has been fetched.
                            View.render('home');
                        });
                    }
                    else {
                        View.render('home');
                    }

                },
                error: function(user, error) {
                    alert("User cancelled the Facebook login or did not fully authorize.");
                }
            });
        };

        (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));

    </script>
</body>

</html>